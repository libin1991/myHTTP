# 如何手写一款KOA中间件实现断点续传

这几天在认认真真地学习KOA框架，了解它的原理以及KOA中间件的实现方法。在研究KOA如何处理上传的表单数据的时候，我灵光一闪，这是不是可以用于断点续传？

断点续传并不是服务器端一端的自high，他还需要前端的配合，而且我只准备扒拉一个大致的雏形，所以这个功能我准备：
* 后端：手写KOA中间件处理断点数据
* 前端：原生JS

断点续传的过程不复杂，但是还是有许多小知识点需要get，不然很难理解断点续传的工作过程。实现断点续传的方式有很多，不过我只研究了ajax的方式，所以预备小知识点如下：

* KOA部分：
    * Headers的`content-type`
    * http中`request`的`data`和`end`监听事件。
    * Buffer的处理
* 前端部分：
    * H5中fileAPi的`slice`方法
    * JS的原生AJAX实现方式`XMLHttpRequest`
    * 封装表单数据`FormData`



